<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>Edi Liberato blog</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="2D and 3D truss and frame finite element analysis FEA FEM in python">
  <meta name="author" content="Edi Liberato">
  <meta name="generator" content="Hugo 0.154.5">

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://eddieliberato.github.io/plugins/bootstrap/bootstrap.min.css">
  
  <link rel="stylesheet" href="https://eddieliberato.github.io/plugins/themify-icons/themify-icons.css">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://eddieliberato.github.io/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://eddieliberato.github.io/images/favicon.png" type="image/x-icon">
  <link rel="icon" href="https://eddieliberato.github.io/images/favicon.png" type="image/x-icon">

  

  
<script type="importmap">
{
  "imports": {
    "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
    "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
  }
}
</script>

</head>

<body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      <a class="navbar-brand mobile-view" href="https://eddieliberato.github.io/"><img class="img-fluid"
          src="https://eddieliberato.github.io/images/logo.png" alt="Edi Liberato blog"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <div class="desktop-view">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.youtube.com/user/eddiekvh"><i class="ti-youtube"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://github.com/eddieliberato"><i class="ti-github"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.instagram.com/eddieliberato"><i class="ti-instagram"></i></a>
            </li>
            
          </ul>
        </div>

        <a class="navbar-brand mx-auto desktop-view" href="https://eddieliberato.github.io/"><img class="img-fluid"
            src="https://eddieliberato.github.io/images/logo.png" alt="Edi Liberato blog"></a>

        <ul class="navbar-nav">
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://eddieliberato.github.io/about">About</a>
          </li>
          
          
        </ul>

        
        <!-- search -->
        <div class="search pl-lg-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="https://eddieliberato.github.io//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="Type & Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        

        
      </div>
    </nav>
  </div>
</header>
<!-- /navigation -->

<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-lg-12 mx-auto">
        
        <a href="/categories/engineering"
          class="text-primary">Engineering</a>
        
        <h2>Direct Stiffness Method in Python: Trusses and Frames</h2>
        <div class="mb-3 post-meta">
          <span>By Edi Liberato</span>
          
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>28 February 2022</span>
          
        </div>
        
        <img src="https://eddieliberato.github.io/images/post/trusses-and-frames/2d_frame.svg" class="img mb-4" alt="Direct Stiffness Method in Python: Trusses and Frames">
        
        <div class ="tags-border">
          <div class="content mb-5">
            <p>This post is about some finite element method code that I wrote back in 2014. I am sharing it here, even though I never finished the data visualization part I wanted back then.</p>
<div>
    <h4>Table of Contents</h4>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#trusses">Trusses</a>
      <ul>
        <li><a href="#2d-truss">2D Truss</a></li>
        <li><a href="#space-truss">Space Truss</a></li>
      </ul>
    </li>
    <li><a href="#frames">Frames</a>
      <ul>
        <li><a href="#portal-frame">Portal Frame</a></li>
        <li><a href="#3d-frame">3D Frame</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div>

<p>I won&rsquo;t write about theory after all there&rsquo;s a million books out there about this subject. I&rsquo;m just sharing my take on hands on code, something that you don&rsquo;t usually find in books. The code is written in python.</p>
<p>At the time I was heavily inspired by <a href="https://sukhbinder.wordpress.com/">Sukhbinder Singh</a>. Go check his blog if you didn&rsquo;t yet, tons of interesting stuff there. I will also leave a <strong>big thanks!</strong> for him here, in case he ever happens to read this.</p>
<h3 id="trusses">Trusses</h3>
<h4 id="2d-truss">2D Truss</h4>
<p>Let&rsquo;s start simple with a 2d application of the method. This example is taken from the following book:</p>
<blockquote>
<p>Hutton, D. V. (2004). Fundamentals of finite element analysis. 1st ed. Boston: McGraw-Hill. Page 69.</p>
<blockquote>
<p>The two-element truss in Figure is subjected to external loading as shown. Using the same node and element numbering as in Figure, determine the displacement components of node 3, the reaction force components at nodes 1 and 2, and the element displacements, stresses, and forces. The elements have modulus of elasticity E1=E2=10x10^6 lb/in^2 and cross-sectional areas A1=A2=1.5 in^2.</p>
</blockquote>
</blockquote>
<p><img src="../../images/post/trusses-and-frames/2d_truss.svg" alt="truss_2d"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">##############################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Fem script to compute plane truss displacements and stresses </span>
</span></span><span class="line"><span class="cl"><span class="c1"># written by Eddie Liberato 16/11/16</span>
</span></span><span class="line"><span class="cl"><span class="c1">##############################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># constants</span>
</span></span><span class="line"><span class="cl"><span class="n">E</span><span class="o">=</span><span class="mf">10e06</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span><span class="o">=</span><span class="mf">1.5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># structure geometry </span>
</span></span><span class="line"><span class="cl"><span class="n">node_coord</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">40</span><span class="p">],[</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">]])</span> <span class="c1"># nodes coordinates</span>
</span></span><span class="line"><span class="cl"><span class="n">elem_con</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span> <span class="c1"># elements connectivity</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="n">node_coord</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># sliced array with only x node coordinates</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span><span class="o">=</span><span class="n">node_coord</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># sliced array with only y node coordinates</span>
</span></span><span class="line"><span class="cl"><span class="n">node_count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">node_coord</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elem_count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">elem_con</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">struct_dof</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">node_count</span> <span class="c1"># (entire) structure degrees of freedom</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># matrices initialization</span>
</span></span><span class="line"><span class="cl"><span class="n">displacement</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">struct_dof</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">force</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">struct_dof</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">elem_count</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">stiffness</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">struct_dof</span><span class="p">,</span><span class="n">struct_dof</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># load assignments</span>
</span></span><span class="line"><span class="cl"><span class="n">force</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="mi">500</span>
</span></span><span class="line"><span class="cl"><span class="n">force</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">=</span><span class="mi">300</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># computations</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">elem_count</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">index</span><span class="o">=</span><span class="n">elem_con</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="n">xl</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">yl</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_length</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xl</span><span class="o">*</span><span class="n">xl</span><span class="o">+</span><span class="n">yl</span><span class="o">*</span><span class="n">yl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">c</span><span class="o">=</span><span class="n">xl</span><span class="o">/</span><span class="n">elem_length</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span><span class="o">=</span><span class="n">yl</span><span class="o">/</span><span class="n">elem_length</span>
</span></span><span class="line"><span class="cl">	<span class="n">rot</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                  <span class="p">[</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span><span class="o">*</span><span class="n">s</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                  <span class="p">[</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                  <span class="p">[</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="o">*</span><span class="n">s</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">	<span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">A</span><span class="o">/</span><span class="n">elem_length</span><span class="p">)</span><span class="o">*</span><span class="n">rot</span>
</span></span><span class="line"><span class="cl">	<span class="n">stiffness</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">elem_dof</span><span class="p">,</span> <span class="n">elem_dof</span><span class="p">)]</span> <span class="o">+=</span><span class="n">k</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">suppress_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># constrained degrees of freedom</span>
</span></span><span class="line"><span class="cl"><span class="n">active_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">struct_dof</span><span class="p">),</span> <span class="n">suppress_dof</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">displacement_aux</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">stiffness</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">active_dof</span><span class="p">,</span><span class="n">active_dof</span><span class="p">)],</span> <span class="n">force</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">active_dof</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl"><span class="n">displacement</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">active_dof</span><span class="p">)]</span><span class="o">=</span><span class="n">displacement_aux</span>
</span></span><span class="line"><span class="cl"><span class="n">react</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">stiffness</span><span class="p">,</span> <span class="n">displacement</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">elem_count</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">index</span><span class="o">=</span><span class="n">elem_con</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="n">xl</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">yl</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_length</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xl</span><span class="o">*</span><span class="n">xl</span><span class="o">+</span><span class="n">yl</span><span class="o">*</span><span class="n">yl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">c</span><span class="o">=</span><span class="n">xl</span><span class="o">/</span><span class="n">elem_length</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span><span class="o">=</span><span class="n">yl</span><span class="o">/</span><span class="n">elem_length</span>
</span></span><span class="line"><span class="cl">	<span class="n">sigma</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">elem_length</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">c</span><span class="p">,</span><span class="o">-</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">]),</span> <span class="n">displacement</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">elem_dof</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># emitting results to screen</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;displacements:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">displacement</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;stress:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>The output:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python truss2d.py
</span></span><span class="line"><span class="cl">displacements:
</span></span><span class="line"><span class="cl"> <span class="o">[[</span>0.        <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>0.        <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>0.        <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>0.        <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>0.00053333<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>0.00172941<span class="o">]]</span>
</span></span><span class="line"><span class="cl">stress:
</span></span><span class="line"><span class="cl"> <span class="o">[[</span>282.84271247<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>133.33333333<span class="o">]]</span>
</span></span></code></pre></div><p>All right, pretty cool. Short, dense script. A lot is being done in just a few lines of code. But even cooler is the fact that you can relatively easy expand the method (and the script) to solve 3d trusses, also called space trusses.</p>
<h4 id="space-truss">Space Truss</h4>
<p>I&rsquo;m taking the 3d example from the book of Darryl Logan, a book that I recommend as the first book to be read by someone studying the Finite Element Method.</p>
<blockquote>
<p>Logan D. L. (2007). A First Course in the Finite Element Method. 4th ed. Thomson. Page 98.</p>
<blockquote>
<p>Analyze the space truss shown in Figure. The truss is composed of four nodes, whose coordinates (in meters) are shown in the figure, and three elements, whose cross-sectional areas are all 10x10^-4 m^2. The modulus of elasticity E=210 GPa for all the elements. A load of 20 kN is applied at node 1 in the global x-direction. Nodes 2â€“4 are pin supported and thus constrained from movement in the x, y, and z directions.</p>
</blockquote>
</blockquote>
<p><img src="../../images/post/trusses-and-frames/3d_truss.svg" alt="truss_3d"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">###############################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Fem script to compute space truss displacements and stresses </span>
</span></span><span class="line"><span class="cl"><span class="c1"># written by Eddie Liberato 16/11/16</span>
</span></span><span class="line"><span class="cl"><span class="c1">###############################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># constants</span>
</span></span><span class="line"><span class="cl"><span class="n">E</span><span class="o">=</span><span class="mf">210e09</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span><span class="o">=</span><span class="mf">10e-04</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># structure geometry</span>
</span></span><span class="line"><span class="cl"><span class="n">node_coord</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">12</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">],[</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span> <span class="c1"># node cordenates</span>
</span></span><span class="line"><span class="cl"><span class="n">elem_con</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span> <span class="c1"># elements connectivity</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="n">node_coord</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># sliced array with only x node coord</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span><span class="o">=</span><span class="n">node_coord</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># sliced array with only y node coord</span>
</span></span><span class="line"><span class="cl"><span class="n">z</span><span class="o">=</span><span class="n">node_coord</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># sliced array with only z node coord</span>
</span></span><span class="line"><span class="cl"><span class="n">node_count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">node_coord</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elem_count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">elem_con</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">struct_dof</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">node_count</span> <span class="c1"># (entire) structure degrees of freedom</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># matrices initialization</span>
</span></span><span class="line"><span class="cl"><span class="n">displacement</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">struct_dof</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">force</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">struct_dof</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">elem_count</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">stiffness</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">struct_dof</span><span class="p">,</span><span class="n">struct_dof</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># load assignments</span>
</span></span><span class="line"><span class="cl"><span class="n">force</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mf">20e03</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># computations</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">elem_count</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">index</span><span class="o">=</span><span class="n">elem_con</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="n">xl</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">yl</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">zl</span><span class="o">=</span><span class="n">z</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_length</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xl</span><span class="o">*</span><span class="n">xl</span><span class="o">+</span><span class="n">yl</span><span class="o">*</span><span class="n">yl</span><span class="o">+</span><span class="n">zl</span><span class="o">*</span><span class="n">zl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">cx</span><span class="o">=</span><span class="n">xl</span><span class="o">/</span><span class="n">elem_length</span>
</span></span><span class="line"><span class="cl">	<span class="n">cy</span><span class="o">=</span><span class="n">yl</span><span class="o">/</span><span class="n">elem_length</span>
</span></span><span class="line"><span class="cl">	<span class="n">cz</span><span class="o">=</span><span class="n">zl</span><span class="o">/</span><span class="n">elem_length</span>
</span></span><span class="line"><span class="cl">	<span class="n">trans</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">cx</span><span class="o">*</span><span class="n">cx</span><span class="p">,</span><span class="n">cx</span><span class="o">*</span><span class="n">cy</span><span class="p">,</span><span class="n">cx</span><span class="o">*</span><span class="n">cz</span><span class="p">,</span><span class="o">-</span><span class="n">cx</span><span class="o">*</span><span class="n">cx</span><span class="p">,</span><span class="o">-</span><span class="n">cx</span><span class="o">*</span><span class="n">cy</span><span class="p">,</span><span class="o">-</span><span class="n">cx</span><span class="o">*</span><span class="n">cz</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                    <span class="p">[</span><span class="n">cy</span><span class="o">*</span><span class="n">cx</span><span class="p">,</span><span class="n">cy</span><span class="o">*</span><span class="n">cy</span><span class="p">,</span><span class="n">cy</span><span class="o">*</span><span class="n">cz</span><span class="p">,</span><span class="o">-</span><span class="n">cy</span><span class="o">*</span><span class="n">cx</span><span class="p">,</span><span class="o">-</span><span class="n">cy</span><span class="o">*</span><span class="n">cy</span><span class="p">,</span><span class="o">-</span><span class="n">cy</span><span class="o">*</span><span class="n">cz</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                    <span class="p">[</span><span class="n">cz</span><span class="o">*</span><span class="n">cx</span><span class="p">,</span><span class="n">cz</span><span class="o">*</span><span class="n">cy</span><span class="p">,</span><span class="n">cz</span><span class="o">*</span><span class="n">cz</span><span class="p">,</span><span class="o">-</span><span class="n">cz</span><span class="o">*</span><span class="n">cx</span><span class="p">,</span><span class="o">-</span><span class="n">cz</span><span class="o">*</span><span class="n">cy</span><span class="p">,</span><span class="o">-</span><span class="n">cz</span><span class="o">*</span><span class="n">cz</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                    <span class="p">[</span><span class="o">-</span><span class="n">cx</span><span class="o">*</span><span class="n">cx</span><span class="p">,</span><span class="o">-</span><span class="n">cx</span><span class="o">*</span><span class="n">cy</span><span class="p">,</span><span class="o">-</span><span class="n">cx</span><span class="o">*</span><span class="n">cz</span><span class="p">,</span><span class="n">cx</span><span class="o">*</span><span class="n">cx</span><span class="p">,</span><span class="n">cx</span><span class="o">*</span><span class="n">cy</span><span class="p">,</span><span class="n">cx</span><span class="o">*</span><span class="n">cz</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                    <span class="p">[</span><span class="o">-</span><span class="n">cy</span><span class="o">*</span><span class="n">cx</span><span class="p">,</span><span class="o">-</span><span class="n">cy</span><span class="o">*</span><span class="n">cy</span><span class="p">,</span><span class="o">-</span><span class="n">cy</span><span class="o">*</span><span class="n">cz</span><span class="p">,</span><span class="n">cy</span><span class="o">*</span><span class="n">cx</span><span class="p">,</span><span class="n">cy</span><span class="o">*</span><span class="n">cy</span><span class="p">,</span><span class="n">cy</span><span class="o">*</span><span class="n">cz</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                    <span class="p">[</span><span class="o">-</span><span class="n">cz</span><span class="o">*</span><span class="n">cx</span><span class="p">,</span><span class="o">-</span><span class="n">cz</span><span class="o">*</span><span class="n">cy</span><span class="p">,</span><span class="o">-</span><span class="n">cz</span><span class="o">*</span><span class="n">cz</span><span class="p">,</span><span class="n">cz</span><span class="o">*</span><span class="n">cx</span><span class="p">,</span><span class="n">cz</span><span class="o">*</span><span class="n">cy</span><span class="p">,</span><span class="n">cz</span><span class="o">*</span><span class="n">cz</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">	<span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">A</span><span class="o">/</span><span class="n">elem_length</span><span class="p">)</span><span class="o">*</span><span class="n">trans</span>
</span></span><span class="line"><span class="cl">	<span class="n">stiffness</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">elem_dof</span><span class="p">,</span> <span class="n">elem_dof</span><span class="p">)]</span> <span class="o">+=</span><span class="n">k</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">suppress_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span> <span class="c1"># constrained degrees of freedom</span>
</span></span><span class="line"><span class="cl"><span class="n">active_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">struct_dof</span><span class="p">),</span> <span class="n">suppress_dof</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">displacement_aux</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">stiffness</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">active_dof</span><span class="p">,</span><span class="n">active_dof</span><span class="p">)],</span> <span class="n">force</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">active_dof</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl"><span class="n">displacement</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">active_dof</span><span class="p">)]</span><span class="o">=</span><span class="n">displacement_aux</span>
</span></span><span class="line"><span class="cl"><span class="n">react</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">stiffness</span><span class="p">,</span> <span class="n">displacement</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">elem_count</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">index</span><span class="o">=</span><span class="n">elem_con</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="n">xl</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">yl</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">zl</span><span class="o">=</span><span class="n">z</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_length</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xl</span><span class="o">*</span><span class="n">xl</span><span class="o">+</span><span class="n">yl</span><span class="o">*</span><span class="n">yl</span><span class="o">+</span><span class="n">zl</span><span class="o">*</span><span class="n">zl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">cx</span><span class="o">=</span><span class="n">xl</span><span class="o">/</span><span class="n">elem_length</span>
</span></span><span class="line"><span class="cl">	<span class="n">cy</span><span class="o">=</span><span class="n">yl</span><span class="o">/</span><span class="n">elem_length</span>
</span></span><span class="line"><span class="cl">	<span class="n">cz</span><span class="o">=</span><span class="n">zl</span><span class="o">/</span><span class="n">elem_length</span>
</span></span><span class="line"><span class="cl">	<span class="n">sigma</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">elem_length</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">cx</span><span class="p">,</span><span class="o">-</span><span class="n">cy</span><span class="p">,</span><span class="o">-</span><span class="n">cz</span><span class="p">,</span><span class="n">cx</span><span class="p">,</span><span class="n">cy</span><span class="p">,</span><span class="n">cz</span><span class="p">]),</span> <span class="n">displacement</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">elem_dof</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># emitting results to screen</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;reactions:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">react</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">node_count</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;displacements:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">displacement</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;stress:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>The output:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python truss3d.py
</span></span><span class="line"><span class="cl">reactions:
</span></span><span class="line"><span class="cl"> <span class="o">[[</span> 2.000e+04 -1.137e-13 -9.095e-13<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-1.895e+04  4.737e+03  6.316e+03<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00  0.000e+00 -4.211e+03<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-1.053e+03 -4.737e+03 -2.105e+03<span class="o">]]</span>
</span></span><span class="line"><span class="cl">displacements:
</span></span><span class="line"><span class="cl"> <span class="o">[[</span> 1.384e-03<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-5.157e-05<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 6.015e-05<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]]</span>
</span></span><span class="line"><span class="cl">stress:
</span></span><span class="line"><span class="cl"> <span class="o">[[</span>20526315.789<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 4210526.316<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-5289408.222<span class="o">]]</span>
</span></span></code></pre></div><h3 id="frames">Frames</h3>
<h4 id="portal-frame">Portal Frame</h4>
<p>A brief tale about how this started: My young self trying to design a bamboo bicycle frame. Unfortunately the bike itself never passed the drawing board stage, but in the process I learned a lot about mechanical structures and designing things using unusual materials. Here I share part of the effort, more specifically, the efforts to calculate the forces on members of the frame.</p>
<p>As you&rsquo;ll see the examples are not about bike frames, but simpler structures. This is due to the fact that I don&rsquo;t want to (re)write about theory here. I just want to share hands on code. The examples are taken from a book where you can find more detailed explanation about conceptual part of the method.</p>
<blockquote>
<p>Logan D. L. (2007). A First Course in the Finite Element Method. 4th ed. Thomson. Page 218.</p>
<blockquote>
<p>As the first example of rigid plane frame analysis, solve the simple â€˜â€˜bentâ€™â€™. The frame is fixed at nodes 1 and 4 and subjected to a positive horizontal force of 10,000 lb applied at node 2 and to a positive moment of 5000 lb-in. applied at node 3. The global-coordinate axes and the element lengths are shown in Figure. Let E=30x10^6 psi and A=10 in^2 for all elements, and let I=200 in^4 for elements 1 and 3, and I=100^4 for element 2.</p>
</blockquote>
</blockquote>
<p><img src="../../images/post/trusses-and-frames/2d_frame.svg" alt="frame_2d"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">###############################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Fem script to compute plane frame forces and moments</span>
</span></span><span class="line"><span class="cl"><span class="c1"># written by Eddie Liberato 16/11/16</span>
</span></span><span class="line"><span class="cl"><span class="c1">###############################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># constants</span>
</span></span><span class="line"><span class="cl"><span class="n">E</span><span class="o">=</span><span class="mf">30e06</span>         <span class="c1"># psi</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span><span class="o">=</span><span class="mi">10</span>            <span class="c1"># in^2</span>
</span></span><span class="line"><span class="cl"><span class="n">I</span><span class="o">=</span><span class="p">[</span><span class="mi">200</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span> <span class="c1"># in^4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># structure geometry</span>
</span></span><span class="line"><span class="cl"><span class="n">node_coord</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="mi">12</span><span class="p">],[</span><span class="mi">10</span><span class="o">*</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="mi">12</span><span class="p">],[</span><span class="mi">10</span><span class="o">*</span><span class="mi">12</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span> <span class="c1"># node coordinates</span>
</span></span><span class="line"><span class="cl"><span class="n">elem_con</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span> <span class="c1"># elements connectivity</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="n">node_coord</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># sliced array with only x node coord</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span><span class="o">=</span><span class="n">node_coord</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># sliced array with only y node coord</span>
</span></span><span class="line"><span class="cl"><span class="n">node_count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">node_coord</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elem_count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">elem_con</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">struct_dof</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">node_count</span> <span class="c1"># (entire) structure degrees of freedom</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># matrices initialization</span>
</span></span><span class="line"><span class="cl"><span class="n">displacement</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">struct_dof</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">force</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">struct_dof</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">stiffness</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">struct_dof</span><span class="p">,</span><span class="n">struct_dof</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># load assignments</span>
</span></span><span class="line"><span class="cl"><span class="n">force</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="mi">10000</span>
</span></span><span class="line"><span class="cl"><span class="n">force</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="mi">5000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># computations</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">elem_count</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">index</span><span class="o">=</span><span class="n">elem_con</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">elem_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                           <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">xl</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">        <span class="n">yl</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">        <span class="n">el</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xl</span><span class="o">*</span><span class="n">xl</span><span class="o">+</span><span class="n">yl</span><span class="o">*</span><span class="n">yl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="o">=</span><span class="n">xl</span><span class="o">/</span><span class="n">el</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="o">=</span><span class="n">yl</span><span class="o">/</span><span class="n">el</span>
</span></span><span class="line"><span class="cl">        <span class="n">kglobal</span><span class="o">=</span><span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">el</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">,(</span><span class="n">A</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="p">)</span><span class="o">*</span><span class="n">s</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                 <span class="p">[(</span><span class="n">A</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">A</span><span class="o">*</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                 <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">],</span> <span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]],</span>
</span></span><span class="line"><span class="cl">                                 <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">A</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">*</span><span class="n">s</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                 <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">A</span><span class="o">*</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                                 <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="p">)</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">],</span> <span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]]])</span>
</span></span><span class="line"><span class="cl">        <span class="n">stiffness</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">elem_dof</span><span class="p">,</span> <span class="n">elem_dof</span><span class="p">)]</span> <span class="o">+=</span><span class="n">kglobal</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">suppress_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">active_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">struct_dof</span><span class="p">),</span> <span class="n">suppress_dof</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">displacement_aux</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">stiffness</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">active_dof</span><span class="p">,</span><span class="n">active_dof</span><span class="p">)],</span> <span class="n">force</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">active_dof</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl"><span class="n">displacement</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">active_dof</span><span class="p">)]</span><span class="o">=</span><span class="n">displacement_aux</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;displacements:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">displacement</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">elem_count</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;forces on element </span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">index</span><span class="o">=</span><span class="n">elem_con</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="n">xl</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">yl</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">el</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xl</span><span class="o">*</span><span class="n">xl</span><span class="o">+</span><span class="n">yl</span><span class="o">*</span><span class="n">yl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">c</span><span class="o">=</span><span class="n">xl</span><span class="o">/</span><span class="n">el</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span><span class="o">=</span><span class="n">yl</span><span class="o">/</span><span class="n">el</span>
</span></span><span class="line"><span class="cl">	<span class="n">trans</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">	<span class="n">Td</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">trans</span><span class="p">,</span> <span class="n">displacement</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">elem_dof</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">	<span class="n">c1</span><span class="o">=</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="n">el</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">c2</span><span class="o">=</span><span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">klocal</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">c1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">c1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="o">*</span><span class="n">c2</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">c2</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">el</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">el</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">el</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                     <span class="p">[</span><span class="o">-</span><span class="n">c1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">c2</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="o">*</span><span class="n">c2</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">el</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">el</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">el</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_forces</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">klocal</span><span class="p">,</span><span class="n">Td</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">elem_forces</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>The output:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python frame2d.py
</span></span><span class="line"><span class="cl">displacements:
</span></span><span class="line"><span class="cl"> <span class="o">[[</span> 0.        <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.        <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.        <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.21136266<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.00148133<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-0.00152603<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.20935933<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-0.00148133<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-0.001486  <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.        <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.        <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.        <span class="o">]]</span>
</span></span><span class="line"><span class="cl">forces on element <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="o">[[</span> -3703.31950207<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>  4991.69435216<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>375803.32156987<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>  3703.31950207<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> -4991.69435216<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>223200.00068927<span class="o">]]</span>
</span></span><span class="line"><span class="cl">forces on element <span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="o">[[</span>   5008.30564784<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>  -3703.31950207<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-223200.00068927<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>  -5008.30564784<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>   3703.31950207<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-221198.3395597 <span class="o">]]</span>
</span></span><span class="line"><span class="cl">forces on element <span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="o">[[</span>  3703.31950207<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>  5008.30564784<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>226198.3395597 <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> -3703.31950207<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> -5008.30564784<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>374798.33818117<span class="o">]]</span>
</span></span></code></pre></div><h4 id="3d-frame">3D Frame</h4>
<p>Finally the script I used in practice when I was designing the bike, the 3d frame. Things get interesting and relatively complex here. You&rsquo;ll need to care about directions and torsional parameters. Not for the faint of heart.</p>
<p>There&rsquo;s a bit of bloat there because I failed the don&rsquo;t repeat yourself mantra. I said to myself I&rsquo;d come back later and rewrite that part but ended up never doing it.</p>
<blockquote>
<p>Logan D. L. (2007). A First Course in the Finite Element Method. 4th ed. Thomson. Page 262.</p>
<blockquote>
<p>Determine the displacements and rotations at the free node (node 1) and the element local forces and moments for the space frame shown in Figure. Also verify equilibrium at node 1. Let E=30 000 Ksi, G=10 000 Ksi, J=50 in^4, Iy=100 in^4, Iz=100 in^4, A=10 in^2, and L=100 inches for all three beam elements.</p>
</blockquote>
</blockquote>
<p><img src="../../images/post/trusses-and-frames/3d_frame.svg" alt="frame_3d"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">###############################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Fem script to compute space frame forces and moments</span>
</span></span><span class="line"><span class="cl"><span class="c1"># written by Eddie Liberato 16/11/16</span>
</span></span><span class="line"><span class="cl"><span class="c1">###############################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># constants</span>
</span></span><span class="line"><span class="cl"><span class="n">E</span><span class="o">=</span><span class="mf">30e03</span>     <span class="c1"># psi</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span><span class="o">=</span><span class="mi">10</span>        <span class="c1"># in^2</span>
</span></span><span class="line"><span class="cl"><span class="n">Iy</span><span class="o">=</span><span class="mi">100</span>
</span></span><span class="line"><span class="cl"><span class="n">Iz</span><span class="o">=</span><span class="mi">100</span>
</span></span><span class="line"><span class="cl"><span class="n">Gs</span><span class="o">=</span><span class="mi">10000</span>
</span></span><span class="line"><span class="cl"><span class="n">Jt</span><span class="o">=</span><span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># structure geometry</span>
</span></span><span class="line"><span class="cl"><span class="n">node_coord</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span> <span class="c1"># node coordinates</span>
</span></span><span class="line"><span class="cl"><span class="n">elem_con</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span> <span class="c1"># elements connectivity</span>
</span></span><span class="line"><span class="cl"><span class="n">xx</span><span class="o">=</span><span class="n">node_coord</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># sliced array with only x node coord</span>
</span></span><span class="line"><span class="cl"><span class="n">yy</span><span class="o">=</span><span class="n">node_coord</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># sliced array with only y node coord</span>
</span></span><span class="line"><span class="cl"><span class="n">zz</span><span class="o">=</span><span class="n">node_coord</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># sliced array with only z node coord</span>
</span></span><span class="line"><span class="cl"><span class="n">node_count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">node_coord</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elem_count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">elem_con</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">struct_dof</span><span class="o">=</span><span class="mi">6</span><span class="o">*</span><span class="n">node_count</span> <span class="c1"># (entire) structure degrees of freedom</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># matrices initialization</span>
</span></span><span class="line"><span class="cl"><span class="n">displacement</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">struct_dof</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">force</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">struct_dof</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">stiffness</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">struct_dof</span><span class="p">,</span><span class="n">struct_dof</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># load assignments</span>
</span></span><span class="line"><span class="cl"><span class="n">force</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="n">force</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=-</span><span class="mi">1000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># computations</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">elem_count</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">index</span><span class="o">=</span><span class="n">elem_con</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">5</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="n">xl</span><span class="o">=</span><span class="n">xx</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">xx</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">yl</span><span class="o">=</span><span class="n">yy</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">yy</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">zl</span><span class="o">=</span><span class="n">zz</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">zz</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">el</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xl</span><span class="o">*</span><span class="n">xl</span><span class="o">+</span><span class="n">yl</span><span class="o">*</span><span class="n">yl</span><span class="o">+</span><span class="n">zl</span><span class="o">*</span><span class="n">zl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">lx</span><span class="o">=</span><span class="n">xl</span><span class="o">/</span><span class="n">el</span>
</span></span><span class="line"><span class="cl">	<span class="n">mx</span><span class="o">=</span><span class="n">yl</span><span class="o">/</span><span class="n">el</span>
</span></span><span class="line"><span class="cl">	<span class="n">nx</span><span class="o">=</span><span class="n">zl</span><span class="o">/</span><span class="n">el</span>
</span></span><span class="line"><span class="cl">	<span class="n">Di</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lx</span><span class="o">*</span><span class="n">lx</span><span class="o">+</span><span class="n">mx</span><span class="o">*</span><span class="n">mx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">Di</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">nx</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">transf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">	<span class="k">elif</span> <span class="n">Di</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">nx</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">transf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">ly</span><span class="o">=-</span><span class="n">mx</span><span class="o">/</span><span class="n">Di</span>
</span></span><span class="line"><span class="cl">		<span class="n">my</span><span class="o">=</span><span class="n">lx</span><span class="o">/</span><span class="n">Di</span>
</span></span><span class="line"><span class="cl">		<span class="n">ny</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">		<span class="n">lz</span><span class="o">=-</span><span class="n">lx</span><span class="o">*</span><span class="n">nx</span><span class="o">/</span><span class="n">Di</span>
</span></span><span class="line"><span class="cl">		<span class="n">mz</span><span class="o">=-</span><span class="n">mx</span><span class="o">*</span><span class="n">nx</span><span class="o">/</span><span class="n">Di</span>
</span></span><span class="line"><span class="cl">		<span class="n">nz</span><span class="o">=</span><span class="n">Di</span>
</span></span><span class="line"><span class="cl">		<span class="n">transf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">lx</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="n">ly</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="n">lz</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lx</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ly</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lz</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lx</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ly</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lz</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lx</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">nx</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ly</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">ny</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lz</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">nz</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">klocal</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Gs</span><span class="o">*</span><span class="n">Jt</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">Gs</span><span class="o">*</span><span class="n">Jt</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="o">-</span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">Gs</span><span class="o">*</span><span class="n">Jt</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Gs</span><span class="o">*</span><span class="n">Jt</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">	<span class="n">tptf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">transf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">tpklprod</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tptf</span><span class="p">,</span><span class="n">klocal</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">kglobal</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tpklprod</span><span class="p">,</span><span class="n">transf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">stiffness</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">elem_dof</span><span class="p">,</span> <span class="n">elem_dof</span><span class="p">)]</span> <span class="o">+=</span><span class="n">kglobal</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">suppress_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">active_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">struct_dof</span><span class="p">),</span> <span class="n">suppress_dof</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">displacement_aux</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">stiffness</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">active_dof</span><span class="p">,</span><span class="n">active_dof</span><span class="p">)],</span> <span class="n">force</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">active_dof</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl"><span class="n">displacement</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">active_dof</span><span class="p">)]</span><span class="o">=</span><span class="n">displacement_aux</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;displacements:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">displacement</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">elem_count</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;forces on element </span><span class="si">{</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">index</span><span class="o">=</span><span class="n">elem_con</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_dof</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">5</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">	<span class="n">xl</span><span class="o">=</span><span class="n">xx</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">xx</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">yl</span><span class="o">=</span><span class="n">yy</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">yy</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">zl</span><span class="o">=</span><span class="n">zz</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span><span class="n">zz</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">	<span class="n">el</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xl</span><span class="o">*</span><span class="n">xl</span><span class="o">+</span><span class="n">yl</span><span class="o">*</span><span class="n">yl</span><span class="o">+</span><span class="n">zl</span><span class="o">*</span><span class="n">zl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">lx</span><span class="o">=</span><span class="n">xl</span><span class="o">/</span><span class="n">el</span>
</span></span><span class="line"><span class="cl">	<span class="n">mx</span><span class="o">=</span><span class="n">yl</span><span class="o">/</span><span class="n">el</span>
</span></span><span class="line"><span class="cl">	<span class="n">nx</span><span class="o">=</span><span class="n">zl</span><span class="o">/</span><span class="n">el</span>
</span></span><span class="line"><span class="cl">	<span class="n">Di</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lx</span><span class="o">*</span><span class="n">lx</span><span class="o">+</span><span class="n">mx</span><span class="o">*</span><span class="n">mx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">Di</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">nx</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">transf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">	<span class="k">elif</span> <span class="n">Di</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">nx</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">transf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">ly</span><span class="o">=-</span><span class="n">mx</span><span class="o">/</span><span class="n">Di</span>
</span></span><span class="line"><span class="cl">		<span class="n">my</span><span class="o">=</span><span class="n">lx</span><span class="o">/</span><span class="n">Di</span>
</span></span><span class="line"><span class="cl">		<span class="n">ny</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">		<span class="n">lz</span><span class="o">=-</span><span class="n">lx</span><span class="o">*</span><span class="n">nx</span><span class="o">/</span><span class="n">Di</span>
</span></span><span class="line"><span class="cl">		<span class="n">mz</span><span class="o">=-</span><span class="n">mx</span><span class="o">*</span><span class="n">nx</span><span class="o">/</span><span class="n">Di</span>
</span></span><span class="line"><span class="cl">		<span class="n">nz</span><span class="o">=</span><span class="n">Di</span>
</span></span><span class="line"><span class="cl">		<span class="n">transf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">lx</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="n">ly</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="n">lz</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lx</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ly</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lz</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lx</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ly</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lz</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lx</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">nx</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ly</span><span class="p">,</span><span class="n">my</span><span class="p">,</span><span class="n">ny</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lz</span><span class="p">,</span><span class="n">mz</span><span class="p">,</span><span class="n">nz</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">Td</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">transf</span><span class="p">,</span> <span class="n">displacement</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">elem_dof</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">	<span class="n">klocal</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Gs</span><span class="o">*</span><span class="n">Jt</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">Gs</span><span class="o">*</span><span class="n">Jt</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="o">-</span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">Gs</span><span class="o">*</span><span class="n">Jt</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Gs</span><span class="o">*</span><span class="n">Jt</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iy</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">Iz</span><span class="o">/</span><span class="n">el</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">	<span class="n">elem_forces</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">klocal</span><span class="p">,</span><span class="n">Td</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">elem_forces</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>The output:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python frame3d.py
</span></span><span class="line"><span class="cl">displacements:
</span></span><span class="line"><span class="cl"> <span class="o">[[</span> 7.098e-05<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-1.400e-02<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-2.352e-03<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-3.996e-03<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 1.780e-05<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-1.033e-04<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 0.000e+00<span class="o">]]</span>
</span></span><span class="line"><span class="cl">forces on element <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="o">[[</span> -0.213<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>  0.318<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>  0.053<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 19.98 <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> -3.165<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 18.991<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>  0.213<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> -0.318<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> -0.053<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-19.98 <span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> -2.097<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 12.79 <span class="o">]]</span>
</span></span><span class="line"><span class="cl">forces on element <span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="o">[[</span> 7.056e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 7.697e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-2.949e-02<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 5.167e-01<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 9.403e-01<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 2.650e+02<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-7.056e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-7.697e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 2.949e-02<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-5.167e-01<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 2.008e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 5.047e+02<span class="o">]]</span>
</span></span><span class="line"><span class="cl">forces on element <span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="o">[[</span> 4.199e+01<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-1.835e-01<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-7.108e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-8.900e-02<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 2.355e+02<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-6.073e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-4.199e+01<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 1.835e-01<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 7.108e+00<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 8.900e-02<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span> 4.753e+02<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-1.227e+01<span class="o">]]</span>
</span></span></code></pre></div><p>This last script craves for refactoring, but hey, it works. At the time I wanted to find some visualization library, rewrite and expand the code. I thought I&rsquo;d post it only after it was finished. Fast forward to 2022, I realized I won&rsquo;t do it anytime soon as I don&rsquo;t design structural things anymore. There it is, anyway. Hopefully it can help someone.</p>
<p>Cheers,</p>
<p>Edi</p>

          </div>
        </div>
        
        
      </div>
    </div>
  </div>
</section>



<footer>
  <div class="container">
    <div class="row justify-content-center">

      
      <div class="widget col-lg-12">
          <ul class="list-inline">
            <li class="list-inline-item"><a class="d-block p-2 bg-primary text-white"
                                            href="/tags/3d-printing">3d printing</a></li>
            <li class="list-inline-item"><a class="d-block p-2 bg-primary text-white"
                                            href="/tags/cad">Cad</a></li>
            <li class="list-inline-item"><a class="d-block p-2 bg-primary text-white"
                                            href="/tags/cadquery">Cadquery</a></li>
            <li class="list-inline-item"><a class="d-block p-2 bg-primary text-white"
                                            href="/tags/libfive">Libfive</a></li>
            <li class="list-inline-item"><a class="d-block p-2 bg-primary text-white"
                                            href="/tags/lisp">Lisp</a></li>
            <li class="list-inline-item"><a class="d-block p-2 bg-primary text-white"
                                            href="/tags/music">Music</a></li>
            <li class="list-inline-item"><a class="d-block p-2 bg-primary text-white"
                                            href="/tags/programming">Programming</a></li>
            <li class="list-inline-item"><a class="d-block p-2 bg-primary text-white"
                                            href="/tags/python">Python</a></li>
            <li class="list-inline-item"><a class="d-block p-2 bg-primary text-white"
                                            href="/tags/scheme">Scheme</a></li>
          </ul>
      </div>

      
        
          <div class="col-lg-3 mb-5">
            <h6 class="mb-4">Contact Me</h6>
              <ul class="list-unstyled">
              
                <li class="mb-3"><a class="text-dark" href="mailto:eddie.liberatoe@gmail.com"><i
                                    class="ti-email mr-3 text-primary"></i>eddie.liberatoe@gmail.com</a>
              
                </li>

              
                <li class="mb-3"><i class="ti-location-pin mr-3 text-primary"></i>ZÃ¼rich, Switzerland</li>
              
                </li>
            </ul>
             
          </div>


      <div class="col-lg-3 mb-5">
        <h6 class="mb-4">Categories</h6>
        <ul class="list-unstyled">
          <li class="mb-3"><a class="text-dark"
              href="/categories/engineering">Engineering</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/non-technical">Non technical</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/programming">Programming</a>
          </li>
        </ul>
      </div>

      <div class="col-lg-3 mb-5">
        <h6 class="mb-4">Quick Links</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://eddieliberato.github.io/about">About</a></li>
          
        </ul>
      </div>

    </div>
  </div>
</footer>

<script>
  var indexURL = "https://eddieliberato.github.io/index.json"
</script>

<!-- JS Plugins -->

<script src="https://eddieliberato.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://eddieliberato.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://eddieliberato.github.io/plugins/search/fuse.min.js"></script>

<script src="https://eddieliberato.github.io/plugins/search/mark.js"></script>

<script src="https://eddieliberato.github.io/plugins/search/search.js"></script>


<!-- Main Script -->

<script src="https://eddieliberato.github.io/js/script.min.js"></script>




</body>
</html>
